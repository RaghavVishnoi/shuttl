 <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAWdJ3F1a1pmCUjyHaINmV1_nOJ6hpbArM&libraries=places&callback=initMap"
        async defer></script>
 <script>
  window.onload = function() {
   initMap();
  };
     

 function initMap() {
   debugger
  var directionsService = new google.maps.DirectionsService;
  var directionsDisplay = new google.maps.DirectionsRenderer;
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 6,
    center: {lat: 28.5846875, lng: -77.3159296}
  });
  directionsDisplay.setMap(map);
calculateAndDisplayRoute(directionsService, directionsDisplay);


 
function calculateAndDisplayRoute(directionsService, directionsDisplay) {
  var waypts = [];
   
  
  <%RouteSuggestionsSlot.slot_points(params[:route_id]).each do |route|%>
     waypts.push({
        location: new google.maps.LatLng(<%=route.lat%>,<%=route.long%>),
        stopover: true

      });
  <%end%>
   
 
     


  directionsService.route({

    origin: 'Sector-2 Noida',
    destination: 'Sector-65 Noida',
    waypoints: waypts,
    optimizeWaypoints: true,
    travelMode: google.maps.TravelMode.DRIVING
  }, function(response, status) {
    if (status === google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response);
      var route = response.routes[0];
      var summaryPanel = document.getElementById('directions-panel');
     // summaryPanel.innerHTML = '';
      // For each route, display summary information.
      for (var i = 0; i < route.legs.length; i++) {
        var routeSegment = i + 1;
        //summaryPanel.innerHTML += '<b>Route Segment: ' + routeSegment +
            '</b><br>';
        //summaryPanel.innerHTML += route.legs[i].start_address + ' to ';
        //summaryPanel.innerHTML += route.legs[i].end_address + '<br>';
        //summaryPanel.innerHTML += route.legs[i].distance.text + '<br><br>';
      }
    } else {
      window.alert('Directions request failed due to ' + status);
    }
  });
}
  var directionsService = new google.maps.DirectionsService;
  var directionsDisplay = new google.maps.DirectionsRenderer;
  var map = new google.maps.Map(document.getElementById('googleMap'), {
    zoom: 7,
    center: {lat: 41.85, lng: -87.65}
  });
  directionsDisplay.setMap(map);

  var onChangeHandler = function() {
    calculateAndDisplayRoute(directionsService, directionsDisplay);
  };
   
}

function calculateAndDisplayRoute(directionsService, directionsDisplay) {
  directionsService.route({
    origin: "#{params[:s]}",
    destination: "#{params[:d]}",
    travelMode: google.maps.TravelMode.DRIVING
  }, function(response, status) {
    if (status === google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response);
    } else {
      window.alert('Directions request failed due to ' + status);
    }
  });
}
   
   $(document).ready(function() {


      $("#start-time").owlCarousel({
        items : 10,
        navigation: true,
        navigationText: [
        "<i class='fa fa-angle-left'></i>",
        "<i class='fa fa-angle-right'></i>"
        ],
        
      });
    
    $("#start-time2").owlCarousel({
        items : 10,
        navigation: true,
        navigationText: [
        "<i class='fa fa-angle-left'></i>",
        "<i class='fa fa-angle-right'></i>"
        ],
        
      });
    
    
    $("#end-time").owlCarousel({
        items : 10,
     navigation: true,
        navigationText: [
        "<i class='fa fa-angle-left'></i>",
        "<i class='fa fa-angle-right'></i>"
        ],
        
      });
    
    $("#end-time2").owlCarousel({
        items : 10,
     navigation: true,
        navigationText: [
        "<i class='fa fa-angle-left'></i>",
        "<i class='fa fa-angle-right'></i>"
        ],
        
      });

      $('.link').on('click', function(event){
        var $this = $(this);
        if($this.hasClass('clicked')){
          $this.removeClass('clicked');
        } else{
          $('.link').removeClass('clicked');
          $this.addClass('clicked');
        }

      });
        
      $('#default').addClass('clicked');
      val = $('#default').text().split('F')[0]
      
      $.ajax({
        url: "/route_suggestions_pledges/pledge_count",
        type: "GET",
        data: {route_id : <%=params[:route_id]%>,pledge : val},
        dataType: "text",
                 
        complete: function() {

        },

        success: function(data, textStatus, xhr) {
                  
          $('#pledge_count').text(data);
          },
        error: function() {
          $('#pledge_count').text(0);
          }
           
           
      });

      $.ajax({
        url: "/route_suggestions_pledges/pledge_route",
        type: "GET",
        data: {route_id : <%=params[:route_id]%>,pledge : val},
        dataType: "text",
                 
        complete: function() {

        },

        success: function(data, textStatus, xhr) {
                  
          $('#pledge_route').text(data);
          },
        error: function() {
          $('#pledge_route').text(0);
          }
           
           
      });

  $('.check-box li').click(function(){
    $(this).addClass("selected"); 
  });
  
  $("#not-interested").click(function(){
    params = window.location.href.split('?')[1]
    location.href = '/routes/not_interested?'+params
  });
  
  var time = []
  $('.crowl-pad div a').click(function(){
      val = $(this).text().split('F')[0]
      
      $.ajax({
        url: "/route_suggestions_pledges/pledge_count",
        type: "GET",
        data: {route_id : <%=params[:route_id]%>,pledge : val},
        dataType: "text",
                 
        complete: function() {

        },

        success: function(data, textStatus, xhr) {
                  
          $('#pledge_count').text(data);
          },
        error: function() {
          $('#pledge_count').text(0);
          }
           
           
      });

      $.ajax({
        url: "/route_suggestions_pledges/pledge_route",
        type: "GET",
        data: {route_id : <%=params[:route_id]%>,pledge : val},
        dataType: "text",
                 
        complete: function() {

        },

        success: function(data, textStatus, xhr) {
                  
          $('#pledge_route').text(data);
          },
        error: function() {
          $('#pledge_route').text(0);
          }
           
           
      });

          time.pop
          time.push(val)
        
          
      
    })
  $("#next").click(function(){
    params = window.location.href.split('?')[1]
     location.href = '/routes/firsttimeslot?'+params+'&timeslot='+time
   });
});

  
  </script>
 
 
<!-- Loader -->
<div id="page-preloader"><span class="spinner"></span></div>
<!-- Loader end -->
<div class="layout-theme animated-css"  data-header="sticky" data-header-top="200"> 
  <div id="wrapper"> 

  
    
    <!-- HEADER -->
    <header class="header">
      <div class="container">
        <div class="row">
          <div class="col-xs-12"> <a class="header-logo" href="index.html"><img class="header-logo__img" src="/assets/logo.png"  width="100" alt="Logo"></a>
            <div class="header-inner">Home: Office Pickup: Drop for Odd:Even 2.0.</div> 
          </div>
          <!-- end col  --> 
        </div>
        <!-- end row  --> 
      </div>
      <!-- end container--> 
    </header>
    <!-- end header -->
     <section class="section-default">
        <div class="container"> 
          
           <div class="row">
            
          <div class="col-md-12 wow zoomIn" data-wow-duration="1s">
      <div class="location-map-block">
      <h5><%=RouteSuggestion.find(params[:route_id]).name%></h5>
       <div id="map"></div>
     </div> 
     <div class="row">
     <div class="col-md-6 mo">  <strong id= "pledge_count"></strong>/<strong><%=RouteSuggestion.find(params[:route_id]).threshold%></strong> traveller's confirmed</div>
     <input type="hidden" name="pledge_count" id="hidden-value" />
     <div class="col-md-5 mo"><strong id="pledge_route"></strong> days to go</div>
     
     </div>
     
     
    <div class="travel-time-block">
     <h5>What time do you have to reach work?</h5>
     <p class="font-s">(Leave blank if you don't wish to use shuttl in the morning)</p>
     <div class="crowl-pad">
     <div id="start-time2" class="owl-carousel">               
        <a class="item link <%="clicked" if session[:home_slot1] == '8:00' || session[:home_slot2] == '8:00'%>" id="default">8:00<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '08:00:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'8:00')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '8:30' || session[:home_slot2] == '8:30'%>">8:30<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '08:30:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'8:30')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '9:00' || session[:home_slot2] == '9:00'%>">9:00<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '09:00:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'9:00')%></label></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '9:30' || session[:home_slot2] == '9:30'%>">9:30<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '09:30:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'9:30')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '10:00' || session[:home_slot2] == '10:00'%>">10:00<br><span><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '10:00:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'10:00')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '10:30' || session[:home_slot2] == '10:30'%>">10:30<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '10:30:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'10:30')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '11:00' || session[:home_slot2] == '11:00'%>">11:00<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '11:00:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'11:00')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '11:30' || session[:home_slot2] == '11:30'%>">11:30<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '11:30:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'11:30')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '12:00' || session[:home_slot2] == '12:00'%>">12:00<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '12:00:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'12:00')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '12:30' || session[:home_slot2] == '12:30'%>">12:30<br><span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '12:30:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'12:30')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '13:00' || session[:home_slot2] == '13:00'%>">13:00<span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '13:00:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'13:00')%></span></a>
        <a class="item link <%="clicked" if session[:home_slot1] == '13:30' || session[:home_slot2] == '13:30'%>">13:30<span ><%="Filling Fast" if RouteSuggestionsTimestamp.exists?(time_departure: '13:30:00') && RouteSuggestionsPledge.is_fullfast(params[:route_id],'13:30')%></span></a>

              </div>
        
      </div>
      <br>
       <div class="button-block">
      <button class="btn bg-danger" type="button" id="not-interested">Not Interested <i class="fa fa-ban"></i></button>
      <button class="btn btn-info" type="button" id="next">Next <i class="fa fa-chevron-circle-right"></i></button>
      </div>
     </div>
     <!-- end time -->
     
         </div>
    <!-- end coll --> 
     
         </div>
         
        </div>
        <!-- end container --> 
      </section>
      <!-- end section-default -->
   
    
    
  </div>

 <!-- end wrapper --> 
</div>